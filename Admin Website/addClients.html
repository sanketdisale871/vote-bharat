<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>Admin-Clients</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round"
    />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
    />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
    />
    <link
      rel="stylesheet"
      href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
    />

    <link href="addClien.css" rel="stylesheet" type="text/css" />

    <link
      href="https://assets.website-files.com/62aee78456e4207786ac4d18/62b0fad1a8cf6a4c26b3cb5e_Faivcon%2032.svg"
      rel="shortcut icon"
      type="image/x-icon"
    />
    <link
      href="https://assets.website-files.com/62aee78456e4207786ac4d18/62b0fad95898ce119a80c68e_Faivcon%20256.svg"
      rel="apple-touch-icon"
    />
  </head>

  <body>
    <div
      data-collapse="small"
      data-animation="default"
      data-duration="400"
      data-easing="ease"
      data-easing2="ease"
      role="banner"
      class="nav-bar w-nav"
    >
      <div class="nav-container w-container">
        <div class="logo-div" style="width: 58%">
          <a href="#" aria-current="page" class="logotext"
            ><img src="ECI.png" alt="" style="height: 16%; width: 11%"
          /></a>
        </div>

        <nav role="navigation" class="nav-content w-nav-menu">
          <div class="nav-menu">
            <a href="admin_home.html" class="nav-link w-nav-link">Home</a>
            <a href="verifyVoter.html" class="nav-link w-nav-link"
              >Verify Voters</a
            >
            <a href="addClients.html" class="nav-link w-nav-link" style="color: #710101"
              ><b>Add Candidates</b></a
            >
          </div>

          <div class="nav-cta-button-container">
            <a href="#" class="nav-link cta-button1 w-nav-link">Log Out</a>
          </div>
        </nav>
        <div class="menu-button w-nav-button">
          <img
            src="https://assets.website-files.com/62aee78456e4207786ac4d18/62aee78456e4200f2eac4d49_Menu%20Icon.svg"
            loading="lazy"
            width="24"
            alt=""
            class="menu-icon"
          />
        </div>
      </div>
    </div>

    <div
      class="container-xl d-flex justify-content-center align-items-center p-5"
    >
      <div class="table-wrapper">
        <div class="table-title">
          <div class="row">
            <div class="col-sm-6">
              <h2>Add <b>Candidates</b></h2>
            </div>
            <div class="col-sm-6">
              <a
                href="#addEmployeeModal"
                class="btn btn-success"
                data-toggle="modal"
                ><i class="material-icons">&#xE147;</i>
                <span>Add New Candidate</span></a
              >
            </div>
          </div>
        </div>
        <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Political Party</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>Thomas Hardy</td>
              <td>thomashardy@mail.com</td>
              <td>
                <a href="#editEmployeeModal" class="edit" data-toggle="modal"
                  ><i class="material-icons" data-toggle="tooltip" title="Edit"
                    >&#xE254;</i
                  ></a
                >
                <a
                  href="#deleteEmployeeModal"
                  class="delete"
                  data-toggle="modal"
                  ><i
                    class="material-icons"
                    data-toggle="tooltip"
                    title="Delete"
                    >&#xE872;</i
                  ></a
                >
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
    <!-- Add Modal HTML -->
    <div id="addEmployeeModal" class="modal fade">
      <div class="modal-dialog">
        <div class="modal-content">
          <form>
            <div class="modal-header">
              <h4 class="modal-title">Add Candidate</h4>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-hidden="true"
              >
                &times;
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Full Name</label>
                <input type="text" class="form-control addName" required />
              </div>
              <div class="form-group">
                <label>Email</label>
                <input type="email" class="form-control addEmail" required />
              </div>
              <div class="form-group">
                <label>Mobile Number</label>
                <input type="tel" class="form-control addPhone" required />
              </div>
              <div class="form-group">
                <label>Politicle Party</label>
                <input type="text" class="form-control addPoliParty" required />
              </div>
              <div class="form-group">
                <label>Education</label>
                <input type="text" class="form-control addEdu" required />
              </div>
              <div class="form-group">
                <label>Age</label>
                <input type="text" class="form-control addAge" required />
              </div>
              <div class="form-group">
                <label>Region</label>
                <input type="text" class="form-control addRegion" required />
              </div>
              <div class="form-group">
                <label>Previous Work</label>
                <input type="text" class="form-control addPrevWork" required />
              </div>
            </div>
            <div class="modal-footer">
              <input
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
                value="Cancel"
              />
              <input
                type="submit"
                class="btn btn-success addData"
                value="Add"
              />
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- Edit Modal HTML -->
    <div id="editEmployeeModal" class="modal fade">
      <div class="modal-dialog">
        <div class="modal-content">
          <form>
            <div class="modal-header">
              <h4 class="modal-title">Edit Candidate</h4>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-hidden="true"
              >
                &times;
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <label>Full Name</label>
                <input type="text" class="form-control editName" required />
              </div>
              <div class="form-group">
                <label>Email</label>
                <input type="email" class="form-control editEmail" required />
              </div>
              <div class="form-group">
                <label>Mobile Number</label>
                <input type="tel" class="form-control editPhone" required />
              </div>
              <div class="form-group">
                <label>Politicle Party</label>
                <input
                  type="text"
                  class="form-control editPoliParty"
                  required
                />
              </div>
              <div class="form-group">
                <label>Education</label>
                <input type="text" class="form-control editEdu" required />
              </div>
              <div class="form-group">
                <label>Age</label>
                <input type="text" class="form-control editAge" required />
              </div>
              <div class="form-group">
                <label>Region</label>
                <input type="text" class="form-control editRegion" required />
              </div>
              <div class="form-group">
                <label>Previous Work</label>
                <input type="text" class="form-control editPrevWork" required />
              </div>
            </div>
            <input type="hidden" class="edit_key" />
            <div class="modal-footer">
              <input
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
                value="Cancel"
              />
              <input
                type="submit"
                class="btn btn-info saveEditedData"
                value="Save"
              />
            </div>
          </form>
        </div>
      </div>
    </div>
    <!-- Delete Modal HTML -->
    <div id="deleteEmployeeModal" class="modal fade">
      <div class="modal-dialog">
        <div class="modal-content">
          <form>
            <div class="modal-header">
              <h4 class="modal-title">Delete Employee</h4>
              <button
                type="button"
                class="close"
                data-dismiss="modal"
                aria-hidden="true"
              >
                &times;
              </button>
            </div>
            <div class="modal-body">
              <p>Are you sure you want to delete these Records?</p>
              <p class="text-warning">
                <small>This action cannot be undone.</small>
              </p>
            </div>
            <div class="modal-footer">
              <input
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
                value="Cancel"
              />
              <input type="submit" class="btn btn-danger deleteBtn" value="Delete" />
            </div>
          </form>
        </div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-firestore.js"></script>
    <!-- <script src="https://www.gstatic.com/firebasejs/7.15.5/firebase-firebase-auth.js"></script> -->
    <script src="firebase.js"></script>

    <script>
      $(document).ready(function () {
        var employeeCollection = firestore.collection("employee");

        $('[data-toggle="tooltip"]').tooltip();

        function addData(
          addName,
          addEmail,
          addPhone,
          addPoliParty,
          addEdu,
          addAge,
          addRegion,
          addPrevWork
        ) {
          firestore.collection("employee").add({
            Name: addName,
            Email: addEmail,
            Phone: addPhone,
            Political_Party: addPoliParty,
            Education: addEdu,
            Age: addAge,
            Region: addRegion,
            Previous_Work: addPrevWork,
          });
          alert("Data Submitted Successfully.");
        }

        $(".addData").on("click", () => {
          var addName = $(".addName").val();
          var addEmail = $(".addEmail").val();
          var addPhone = $(".addPhone").val();
          var addPoliParty = $(".addPoliParty").val();
          var addEdu = $(".addEdu").val();
          var addAge = $(".addAge").val();
          var addRegion = $(".addRegion").val();
          var addPrevWork = $(".addPrevWork").val();

          $(".addName").val("");
          $(".addEmail").val("");
          $(".addPhone").val("");
          $(".addPoliParty").val("");
          $(".addEdu").val("");
          $(".addAge").val("");
          $(".addRegion").val("");
          $(".addPrevWork").val("");
          addData(
            addName,
            addEmail,
            addPhone,
            addPoliParty,
            addEdu,
            addAge,
            addRegion,
            addPrevWork
          );
          $("#addEmployeeModal").modal("toggle");
        });

        $("tbody").html("");

        employeeCollection.onSnapshot((snapshot) => {
          $("tbody").html("");
          snapshot.forEach((employee) => {
            $("tbody").append(`
                      <tr>
                    <td>${employee.data().Name}</td>
                    <td>${employee.data().Email}</td>
                    <td>${employee.data().Political_Party}</td>
                    <td>
                      <a href="#editEmployeeModal" class="edit" data-toggle="modal"
                        ><i class="material-icons" data-toggle="tooltip" id=${
                          employee.id
                        } title="Edit"
                          >&#xE254;</i
                        ></a
                      >
                      <a
                        href="#deleteEmployeeModal"
                        class="delete"
                        data-toggle="modal"
                        ><i
                          class="material-icons"
                          data-toggle="tooltip"
                          title="Delete"
                          >&#xE872;</i
                        ></a
                      >
                    </td>
                  </tr>
                      `);
          });
        });

        $(document).on("click", ".edit", async function (e) {
          // console.log(e.target.id)
          const postKey = e.target.id;
          //   const postRef = employee.child(postKey);
          //   console.log(postRef);
          var db = firestore
            .collection("employee")
            .doc(postKey)
            .get()
            .then((qs) => {
              // qs.forEach(doc => {
              //     console.log(doc.data())
              // })
              //   console.log(qs.data());
              $(".editName").val(qs.data().Name);
              $(".editEmail").val(qs.data().Email);
              $(".editPhone").val(qs.data().Phone);
              $(".editPoliParty").val(qs.data().Political_Party);
              $(".editEdu").val(qs.data().Education);
              $(".editAge").val(qs.data().Age);
              $(".editRegion").val(qs.data().Region);
              $(".editPrevWork").val(qs.data().Previous_Work);
              $(".edit_key").val(postKey);
            });
        });



 });
    </script>
  </body>
</html>
